/*!
 * Name    : Video Worker
 * Version : 1.0.0
 * Author  : nK <https://nkdev.info>
 * GitHub  : https://github.com/nk-o/video-worker
 */
var VideoWorker=function(o){var i={};function a(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return o[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=o,a.c=i,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,o){e.exports=o(1)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function i(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e}}();function i(){this._done=[],this._fail=[]}function s(e,t,o){e.addEventListener(t,o)}i.prototype={execute:function(e,t){var o=e.length;for(t=Array.prototype.slice.call(t);o--;)e[o].apply(null,t)},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(e){this._done.push(e)},fail:function(e){this._fail.push(e)}};var r=0,p=0,l=0,u=0,y=0,d=new i,f=new i,m=function(){function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var o=this;o.url=e,o.options_default={autoplay:!1,loop:!1,mute:!1,volume:100,showContols:!0,startTime:0,endTime:0},o.options=o.extend({},o.options_default,t),o.videoID=o.parseURL(e),o.videoID&&(o.ID=r++,o.loadAPI(),o.init())}return n(i,[{key:"extend",value:function(o){var i=arguments;return o=o||{},Object.keys(arguments).forEach(function(t){i[t]&&Object.keys(i[t]).forEach(function(e){o[e]=i[t][e]})}),o}},{key:"parseURL",value:function(e){var t,o,i,a,n,r=!(!(t=e.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/))||11!==t[1].length)&&t[1],p=!(!(o=e.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/))||!o[3])&&o[3],l=(i=e.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/),a={},n=0,i.forEach(function(e){var t=e.match(/^(mp4|webm|ogv|ogg)\:(.*)/);t&&t[1]&&t[2]&&(a["ogv"===t[1]?"ogg":t[1]]=t[2],n=1)}),!!n&&a);return r?(this.type="youtube",r):p?(this.type="vimeo",p):!!l&&(this.type="local",l)}},{key:"isValid",value:function(){return!!this.videoID}},{key:"on",value:function(e,t){this.userEventsList=this.userEventsList||[],(this.userEventsList[e]||(this.userEventsList[e]=[])).push(t)}},{key:"off",value:function(o,i){var a=this;this.userEventsList&&this.userEventsList[o]&&(i?this.userEventsList[o].forEach(function(e,t){e===i&&(a.userEventsList[o][t]=!1)}):delete this.userEventsList[o])}},{key:"fire",value:function(e){var t=this,o=[].slice.call(arguments,1);this.userEventsList&&void 0!==this.userEventsList[e]&&this.userEventsList[e].forEach(function(e){e&&e.apply(t,o)})}},{key:"play",value:function(e){var t=this;t.player&&("youtube"===t.type&&t.player.playVideo&&(void 0!==e&&t.player.seekTo(e||0),YT.PlayerState.PLAYING!==t.player.getPlayerState()&&t.player.playVideo()),"vimeo"===t.type&&(void 0!==e&&t.player.setCurrentTime(e),t.player.getPaused().then(function(e){e&&t.player.play()})),"local"===t.type&&(void 0!==e&&(t.player.currentTime=e),t.player.paused&&t.player.play()))}},{key:"pause",value:function(){var t=this;t.player&&("youtube"===t.type&&t.player.pauseVideo&&YT.PlayerState.PLAYING===t.player.getPlayerState()&&t.player.pauseVideo(),"vimeo"===t.type&&t.player.getPaused().then(function(e){e||t.player.pause()}),"local"===t.type&&(t.player.paused||t.player.pause()))}},{key:"mute",value:function(){var e=this;e.player&&("youtube"===e.type&&e.player.mute&&e.player.mute(),"vimeo"===e.type&&e.player.setVolume&&e.player.setVolume(0),"local"===e.type&&(e.$iframe.muted=!0))}},{key:"unmute",value:function(){var e=this;e.player&&("youtube"===e.type&&e.player.mute&&e.player.unmute(),"vimeo"===e.type&&e.player.setVolume&&e.player.setVolume(e.options.volume),"local"===e.type&&(e.$iframe.muted=!1))}},{key:"setVolume",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this;t.player&&e&&("youtube"===t.type&&t.player.setVolume&&t.player.setVolume(e),"vimeo"===t.type&&t.player.setVolume&&t.player.setVolume(e),"local"===t.type&&(t.$iframe.volume=e/100))}},{key:"getImageURL",value:function(t){var o=this;if(o.videoImage)t(o.videoImage);else{if("youtube"===o.type){var e=["maxresdefault","sddefault","hqdefault","0"],i=0,a=new Image;a.onload=function(){120!==(this.naturalWidth||this.width)||i===e.length-1?(o.videoImage="https://img.youtube.com/vi/"+o.videoID+"/"+e[i]+".jpg",t(o.videoImage)):(i++,this.src="https://img.youtube.com/vi/"+o.videoID+"/"+e[i]+".jpg")},a.src="https://img.youtube.com/vi/"+o.videoID+"/"+e[i]+".jpg"}if("vimeo"===o.type){var n=new XMLHttpRequest;n.open("GET","https://vimeo.com/api/v2/video/"+o.videoID+".json",!0),n.onreadystatechange=function(){if(4===this.readyState&&200<=this.status&&this.status<400){var e=JSON.parse(this.responseText);o.videoImage=e[0].thumbnail_large,t(o.videoImage)}},n.send(),n=null}}}},{key:"getIframe",value:function(p){var l=this;l.$iframe?p(l.$iframe):l.onAPIready(function(){var e=void 0;if(l.$iframe||((e=document.createElement("div")).style.display="none"),"youtube"===l.type){l.playerOptions={},l.playerOptions.videoId=l.videoID,l.playerOptions.playerVars={autohide:1,rel:0,autoplay:0,playsinline:1},l.options.showContols||(l.playerOptions.playerVars.iv_load_policy=3,l.playerOptions.playerVars.modestbranding=1,l.playerOptions.playerVars.controls=0,l.playerOptions.playerVars.showinfo=0,l.playerOptions.playerVars.disablekb=1);var t=void 0,o=void 0;l.playerOptions.events={onReady:function(e){l.options.mute?e.target.mute():l.options.volume&&e.target.setVolume(l.options.volume),l.options.autoplay&&l.play(l.options.startTime),l.fire("ready",e)},onStateChange:function(e){l.options.loop&&e.data===YT.PlayerState.ENDED&&l.play(l.options.startTime),t||e.data!==YT.PlayerState.PLAYING||(t=1,l.fire("started",e)),e.data===YT.PlayerState.PLAYING&&l.fire("play",e),e.data===YT.PlayerState.PAUSED&&l.fire("pause",e),e.data===YT.PlayerState.ENDED&&l.fire("end",e),l.options.endTime&&(e.data===YT.PlayerState.PLAYING?o=setInterval(function(){l.options.endTime&&l.player.getCurrentTime()>=l.options.endTime&&(l.options.loop?l.play(l.options.startTime):l.pause())},150):clearInterval(o))}};var i=!l.$iframe;if(i){var a=document.createElement("div");a.setAttribute("id",l.playerID),e.appendChild(a),document.body.appendChild(e)}l.player=l.player||new window.YT.Player(l.playerID,l.playerOptions),i&&(l.$iframe=document.getElementById(l.playerID),l.videoWidth=parseInt(l.$iframe.getAttribute("width"),10)||1280,l.videoHeight=parseInt(l.$iframe.getAttribute("height"),10)||720)}if("vimeo"===l.type){l.playerOptions="",l.playerOptions+="player_id="+l.playerID,l.playerOptions+="&autopause=0",l.playerOptions+="&transparent=0",l.options.showContols||(l.playerOptions+="&badge=0&byline=0&portrait=0&title=0"),l.playerOptions+="&autoplay="+(l.options.autoplay?"1":"0"),l.playerOptions+="&loop="+(l.options.loop?1:0),l.$iframe||(l.$iframe=document.createElement("iframe"),l.$iframe.setAttribute("id",l.playerID),l.$iframe.setAttribute("src","https://player.vimeo.com/video/"+l.videoID+"?"+l.playerOptions),l.$iframe.setAttribute("frameborder","0"),e.appendChild(l.$iframe),document.body.appendChild(e)),l.player=l.player||new Vimeo.Player(l.$iframe),l.player.getVideoWidth().then(function(e){l.videoWidth=e||1280}),l.player.getVideoHeight().then(function(e){l.videoHeight=e||720}),l.options.startTime&&l.options.autoplay&&l.player.setCurrentTime(l.options.startTime),l.options.mute?l.player.setVolume(0):l.options.volume&&l.player.setVolume(l.options.volume);var n=void 0;l.player.on("timeupdate",function(e){n||l.fire("started",e),n=1,l.options.endTime&&l.options.endTime&&e.seconds>=l.options.endTime&&(l.options.loop?l.play(l.options.startTime):l.pause())}),l.player.on("play",function(e){l.fire("play",e),l.options.startTime&&0===e.seconds&&l.play(l.options.startTime)}),l.player.on("pause",function(e){l.fire("pause",e)}),l.player.on("ended",function(e){l.fire("end",e)}),l.player.on("loaded",function(e){l.fire("ready",e)})}if("local"===l.type){l.$iframe||(l.$iframe=document.createElement("video"),l.options.mute?l.$iframe.muted=!0:l.$iframe.volume&&(l.$iframe.volume=l.options.volume/100),l.options.loop&&(l.$iframe.loop=!0),l.$iframe.setAttribute("playsinline",""),l.$iframe.setAttribute("webkit-playsinline",""),l.$iframe.setAttribute("id",l.playerID),e.appendChild(l.$iframe),document.body.appendChild(e),Object.keys(l.videoID).forEach(function(e){var t,o,i,a;t=l.$iframe,o=l.videoID[e],i="video/"+e,(a=document.createElement("source")).src=o,a.type=i,t.appendChild(a)})),l.player=l.player||l.$iframe;var r=void 0;s(l.player,"playing",function(e){r||l.fire("started",e),r=1}),s(l.player,"timeupdate",function(){l.options.endTime&&l.options.endTime&&this.currentTime>=l.options.endTime&&(l.options.loop?l.play(l.options.startTime):l.pause())}),s(l.player,"play",function(e){l.fire("play",e)}),s(l.player,"pause",function(e){l.fire("pause",e)}),s(l.player,"ended",function(e){l.fire("end",e)}),s(l.player,"loadedmetadata",function(){l.videoWidth=this.videoWidth||1280,l.videoHeight=this.videoHeight||720,l.fire("ready"),l.options.autoplay&&l.play(l.options.startTime)})}p(l.$iframe)})}},{key:"init",value:function(){this.playerID="VideoWorker-"+this.ID}},{key:"loadAPI",value:function(){if(!p||!l){var e="";if("youtube"!==this.type||p||(p=1,e="https://www.youtube.com/iframe_api"),"vimeo"!==this.type||l||(l=1,e="https://player.vimeo.com/api/player.js"),e){var t=document.createElement("script"),o=document.getElementsByTagName("head")[0];t.src=e,o.appendChild(t),t=o=null}}}},{key:"onAPIready",value:function(e){if("youtube"===this.type&&("undefined"!=typeof YT&&0!==YT.loaded||u?"object"===("undefined"==typeof YT?"undefined":a(YT))&&1===YT.loaded?e():d.done(function(){e()}):(u=1,window.onYouTubeIframeAPIReady=function(){window.onYouTubeIframeAPIReady=null,d.resolve("done"),e()})),"vimeo"===this.type)if("undefined"!=typeof Vimeo||y)"undefined"!=typeof Vimeo?e():f.done(function(){e()});else{y=1;var t=setInterval(function(){"undefined"!=typeof Vimeo&&(clearInterval(t),f.resolve("done"),e())},20)}"local"===this.type&&e()}}]),i}();t.default=m}]);
//# sourceMappingURL=video-worker.min.js.map
